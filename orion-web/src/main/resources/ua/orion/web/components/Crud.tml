<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<div xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
     xmlns:p="tapestry:parameter"
     xmlns:s="tapestry-library:security">
    <t:zone t:id="listZone">
        <t:if test="error">
            <div class="t-error">${error}</div>
        </t:if>
        <t:ori.InitCall function="closeCkWindow" window="popupWindow"/><!--вызов скрытия окна-->
        <t:grid source="objects" row="object" inplace="true" add="action"
                model="dataSource.getBeanModelForList(objectClass,messages)">
            <p:actionCell>
                <table class="crud-links">
                    <tr>
                        <s:HasPermission permission="${objectClass.simpleName}:update:${id}">
                            <td class="no-background">
                                <t:EventLink t:event="edit" context="object" zone="popupZone"><button class="ui-button-edit-tfalse">${message:action.edit}</button></t:EventLink>
                            </td>
                        </s:HasPermission>
                        <s:HasPermission permission="${objectClass.simpleName}:read:${id}">
                            <td class="no-background">
                                <t:EventLink t:event="view" context="object" zone="popupZone" title="message:action.view"><button class="ui-button-view-tfalse">${message:action.view}</button></t:EventLink>
                            </td>
                        </s:HasPermission>
                        <s:HasPermission permission="${objectClass.simpleName}:delete:${id}">
                            <td class="no-background">
                                <t:EventLink t:event="trydelete" context="object" zone="popupZone" title="message:action.del"><button class="ui-button-del-tfalse">${message:action.del}</button></t:EventLink>
                            </td>
                        </s:HasPermission>
                    </tr>
                </table>
            </p:actionCell>
        </t:grid>
    </t:zone>
    <s:HasPermission permission="${objectClass.simpleName}:insert">
        <t:EventLink class="crud-add" t:event="add" zone="popupZone"><button class="ui-button-add" style="margin-top: 5px">${message:action.add}</button></t:EventLink>
    </s:HasPermission>
    <t:block id="editBlock">
        <t:if test="isedit">
            <t:ori.InitCall function="showCkWindow" window="popupWindow" title="message:label.mode.edit" html="false" showhints="${showHints}" width="750"/><!--вызов показа окна-->
            <t:beaneditform t:id="editForm" object="object" model="dataSource.getBeanModelForEdit(objectClass,messages)"
                            zone="listZone" context="object" submitLabel="message:action.edit"/>
            <p:else>
                <t:ori.InitCall function="showCkWindow" window="popupWindow" title="message:label.mode.add" html="false" showhints="${showHints}" width="750" /><!--вызов показа окна-->
                <t:beaneditform t:id="addForm" object="object" model="dataSource.getBeanModelForAdd(objectClass,messages)"
                                zone="listZone" submitLabel="message:action.add"/>
            </p:else>    
        </t:if>
    </t:block>
    <t:block id="viewBlock">
        <t:ori.InitCall function="showCkWindow" window="popupWindow" title="message:label.mode.view" html="false" width="750"/><!--вызов показа окна-->
        <t:beandisplay t:id="display" object="object" model="dataSource.getBeanModelForView(objectClass,messages)"/>
    </t:block>
    <t:block id="deleteBlock">
        <t:ori.InitCall function="showCkWindow" window="popupWindow" title="message:label.mode.del" html="false" width="192"/><!--вызов показа окна-->
        <table>
            <tr>
                <td>
                    <t:EventLink t:event="delete" context="object" zone="listZone"><button class="ui-button-del">${message:action.del}</button></t:EventLink>
                </td>
                <td>
                    <a href="#" onclick="Windows.close('popupWindow')"><button class="ui-button-cancel">${message:action.cancel}</button></a>
                </td>
            </tr>
        </table>
    </t:block>
    <t:ck.Window t:id="popupWindow" t:style="alphacube" show="false"
                 modal="true" title="mode"
                 width="900" height="500" style="z-index:-1">
        <div class="window-content">
            <t:zone t:id="popupZone"/>
            <a href="#" onclick="Windows.close('popupWindow')">
                <button class="ui-button-close" style="margin-top: 5px">${message:action.closewindow}</button>
            </a>        
        </div>
    </t:ck.Window>
</div>
