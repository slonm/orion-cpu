<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<div xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
     xmlns:p="tapestry:parameter"
     xmlns:s="tapestry-library:security"
     xmlns:j="tapestry-library:jquery">
    <div id="${popupWindowId}" class="dialog" style="display:none;">
        <div class="window-content">
            <t:zone t:id="popupZone"/>
        </div>
    </div>
    <div id="crud-grid-buttons" class="ui-widget-header" style="width: 99%;">
        <s:HasPermission permission="${objectClass.simpleName}:insert">
            <t:EventLink class="crud-add ui-button-add crud-add-record-button" t:event="add" zone="popupZone" style="display:inline-block">${message:action.add}</t:EventLink>
        </s:HasPermission>
        <t:if test="listPage">
            <t:PageLink class="crud-list ui-button-tolist" t:page="prop:listPage" style="display:inline-block">${message:action.list}</t:PageLink>
        </t:if>    
    </div>
    <t:zone t:id="listZone" id="${listZoneId}">
        <t:grid t:mixins="ori/CurrentBeanInformer" source="source" row="object" inplace="true" add="action" reorder="action" lean="true"
                model="dataSource.getBeanModelForList(objectClass,messages)" pagerPosition="literal:bottom">
            <p:actionCell>
                <div class="ui-grid-cell-action-tip" style="display: none">
                    <div class="crud-links">
                        <t:if test="detailPage">
                            <s:HasPermission permission="${objectClass.simpleName}:read:${id}">
                                <div>
                                    <t:PageLink class="crud-detail-pic" t:page="prop:detailPage" context="object" title="message:action.detail"/>
                                </div>
                            </s:HasPermission>
                        </t:if>    
                        <t:if test="showEditButton">
                            <s:HasPermission permission="${objectClass.simpleName}:update:${id}">
                                <div>
                                    <t:EventLink class="crud-edit-pic" t:event="edit" context="object" zone="popupZone" title="message:action.edit"/>
                                </div>
                            </s:HasPermission>
                        </t:if>    
                        <t:if test="showViewButton">
                            <s:HasPermission permission="${objectClass.simpleName}:read:${id}">
                                <div>
                                    <t:EventLink class="crud-view-pic" t:event="view" context="object" zone="popupZone" title="message:action.view"/>
                                </div>
                            </s:HasPermission>
                        </t:if>    
                        <t:if test="showDelButton">
                            <s:HasPermission permission="${objectClass.simpleName}:delete:${id}">
                                <div>
                                    <t:EventLink class="crud-del-pic" t:event="trydelete" context="object" zone="popupZone" title="message:action.del"/>
                                </div>
                            </s:HasPermission>
                        </t:if>    
                    </div>
                </div>
                <button class="ui-button-right-list-tfalse"/>
            </p:actionCell>
        </t:grid>
    </t:zone>
    <t:block id="defaultEditBlock">
        <t:ori.beaneditformext t:mixins="ori/CurrentBeanInformer" t:id="editForm" object="object" model="dataSource.getBeanModelForEdit(objectClass,messages)"
                               zone="prop:listZoneId" submitLabel="message:action.edit" buttons="hideWindowButtonBlock"/>
    </t:block>
    <t:block id="defaultAddBlock">
        <t:ori.beaneditformext t:mixins="ori/CurrentBeanInformer" t:id="addForm" object="object" model="dataSource.getBeanModelForAdd(objectClass,messages)"
                               zone="prop:listZoneId" submitLabel="message:action.add" buttons="hideWindowButtonBlock"/>
    </t:block>
    <t:block id="hideWindowButtonBlock">
        <a href="cancel" onclick="javascript: jQuery('#${popupWindowId}').dialog('close'); return false;" class="ui-button-close" style="margin-top: 5px; display:inline-block">
            ${message:action.cancel}
        </a>        
    </t:block>
    <t:block id="defaultViewBlock">
        <t:beandisplay t:mixins="ori/CurrentBeanInformer" t:id="display" object="object" model="dataSource.getBeanModelForView(objectClass,messages)"/>
        <t:delegate to="hideWindowButtonBlock"/>
    </t:block>
    <t:block id="deleteBlock">
        <table>
            <tr>
                <td>
                    <t:EventLink t:event="delete" context="object" zone="prop:listZoneId" class="ui-button-del" style="display:inline-block">${message:action.del}</t:EventLink>
                </td>
                <td>
                    <a href="cancel" onclick="javascript: jQuery('#${popupWindowId}').dialog('close'); return false;" class="ui-button-cancel" style="display:inline-block">${message:action.cancel}</a>
                </td>
            </tr>
        </table>
    </t:block>
    <div id="ui-ajax-loading-window" title="${message:label.system-message}">
        <span>
            <div class="ui-ajax-loading-window-icon"></div>
        </span>
        <text id="ui-ajax-loading-window-load-text" style="display: none">${message:label.ajax-load-crud}</text>
        <text id="ui-ajax-loading-window-save-text" style="display: none">${message:label.ajax-save-crud}</text>
        <br/>
        <div class="ui-ajax-loading-window-load"></div>
    </div>
</div>